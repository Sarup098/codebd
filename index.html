<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- New handwritten font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            color: #fff;
            overflow: hidden;
        }

        /* --- NEW Candle Blowing Intro --- */
        #candle-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #333; /* Dark background for the cake */
            z-index: 200;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 1s ease-in-out;
        }
        #start-button {
            font-family: 'Caveat', cursive;
            font-size: 2rem;
            color: #1a1a1a;
            background: #fff;
            padding: 1rem 2rem;
            border-radius: 99px;
            cursor: pointer;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* New Cake Styles from your example */
        .cake {
            position: relative;
            width: 250px;
            height: 200px;
            margin-top: -70px;
        }
        .plate {
            width: 270px;
            height: 110px;
            position: absolute;
            bottom: -10px;
            left: -10px;
            background-color: #ccc;
            border-radius: 50%;
            box-shadow: 0 2px 0 #b3b3b3, 0 4px 0 #b3b3b3, 0 5px 40px rgba(0, 0, 0, 0.5);
        }
        .cake > * {
            position: absolute;
        }
        .layer {
            display: block;
            width: 250px;
            height: 100px;
            border-radius: 50%;
            background-color: #553c13;
            box-shadow: 0 2px 0px #6a4b18, 0 4px 0px #33240b, 0 6px 0px #32230b, 0 8px 0px #31230b, 0 10px 0px #30220b, 0 12px 0px #2f220b, 0 14px 0px #2f210a, 0 16px 0px #2e200a, 0 18px 0px #2d200a, 0 20px 0px #2c1f0a, 0 22px 0px #2b1f0a, 0 24px 0px #2a1e09, 0 26px 0px #2a1d09, 0 28px 0px #291d09, 0 30px 0px #281c09;
        }
        .layer-top { top: 0px; }
        .layer-middle { top: 33px; }
        .layer-bottom { top: 66px; }
        .icing {
            top: 2px;
            left: 5px;
            background-color: #2bd6de; /* Changed icing color */
            width: 240px;
            height: 90px;
            border-radius: 50%;
        }
        .icing:before {
            content: "";
            position: absolute;
            top: 4px;
            right: 5px;
            bottom: 6px;
            left: 5px;
            background-color: #a0f0f3; /* Lighter shade of new color */
            box-shadow: 0 0 4px #a0f0f3, 0 0 4px #a0f0f3, 0 0 4px #a0f0f3;
            border-radius: 50%;
            z-index: 1;
        }
        .drip {
            display: block;
            width: 50px;
            height: 60px;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            background-color: #2bd6de; /* Changed drip color */
        }
        .drip1 { top: 53px; left: 5px; transform: skewY(15deg); height: 48px; width: 40px; }
        .drip2 { top: 69px; left: 181px; transform: skewY(-15deg); }
        .drip3 { top: 54px; left: 90px; width: 80px; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; }
        .candle {
            background-color: #7b020b;
            width: 16px;
            height: 50px;
            border-radius: 8px / 4px;
            top: -20px;
            left: 50%;
            margin-left: -8px;
            z-index: 10;
        }
        .candle:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 16px;
            height: 8px;
            border-radius: 50%;
            background-color: #ad030f;
        }
        .flame {
            position: absolute;
            background-color: orange;
            width: 15px;
            height: 35px;
            border-radius: 10px 10px 10px 10px / 25px 25px 10px 10px;
            top: -34px;
            left: 50%;
            margin-left: -7.5px;
            z-index: 10;
            box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5);
            transform-origin: 50% 90%;
            animation: flicker 1s ease-in-out alternate infinite;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        @keyframes flicker {
            0% { transform: skewX(5deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.2), 0 0 20px rgba(255, 165, 0, 0.2), 0 0 60px rgba(255, 165, 0, 0.2), 0 0 80px rgba(255, 165, 0, 0.2); }
            25% { transform: skewX(-5deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5); }
            50% { transform: skewX(10deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.3), 0 0 20px rgba(255, 165, 0, 0.3), 0 0 60px rgba(255, 165, 0, 0.3), 0 0 80px rgba(255, 165, 0, 0.3); }
            75% { transform: skewX(-10deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.4), 0 0 20px rgba(255, 165, 0, 0.4), 0 0 60px rgba(255, 165, 0, 0.4), 0 0 80px rgba(255, 165, 0, 0.4); }
            100% { transform: skewX(5deg); box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5); }
        }
        .flame.out {
            opacity: 0;
            transform: scale(0);
        }
        #blow-instruction {
            margin-top: 2rem;
            font-family: 'Caveat', cursive;
            font-size: 1.5rem;
            color: #fff;
            opacity: 0.8;
        }

        /* --- Cake Intro Styles --- */
        #cake-intro {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffdde1, #e6d4ff, #ffc3a0, #ff9a9e);
            background-size: 400% 400%;
            animation: gradient-animation 10s ease infinite;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 1s ease-in-out;
            overflow: hidden;
        }
        .intro-shape {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.5;
            z-index: 0;
        }
        .intro-shape-1 {
            width: 300px;
            height: 300px;
            background: #ffafbd;
            top: -100px;
            left: -100px;
            animation: intro-move 15s infinite alternate ease-in-out;
        }
        .intro-shape-2 {
            width: 350px;
            height: 350px;
            background: #e6d4ff;
            bottom: -150px;
            right: -150px;
            animation: intro-move 18s infinite alternate ease-in-out -4s;
        }
        @keyframes intro-move {
            from { transform: translate(0, 0) scale(1); }
            to { transform: translate(40px, 20px) scale(1.1); }
        }

        #cake-container {
            position: relative;
            width: 350px;
            height: 350px;
            z-index: 1;
        }
        .cake-piece {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: transform 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        #cake-right {
            z-index: 2;
        }
        
        #swipe-instruction {
            position: absolute;
            top: 5vh;
            font-family: 'Caveat', cursive;
            font-size: 1.5rem;
            color: #8c5a5a;
            opacity: 0.8;
            animation: pulse 2s infinite;
            z-index: 1;
            padding: 0 1rem;
        }
        #muahhh-text {
            position: absolute;
            bottom: 5vh;
            font-family: 'Caveat', cursive;
            font-size: 2.5rem;
            color: #8c5a5a;
            opacity: 0.9;
            z-index: 1;
            padding: 0 1rem;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }
        #cut-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 4;
        }

        #confetti-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            animation: fall 7s linear forwards;
        }
        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(1080deg); opacity: 0; }
        }

        #main-content {
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.1) 1px, transparent 0);
            background-size: 25px 25px;
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1, h2, h3, h4 {
            font-family: 'Caveat', cursive;
        }

        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        .particle {
            position: absolute;
            bottom: -150px;
            animation: drift 20s infinite linear;
            opacity: 0;
            background-size: contain;
            background-repeat: no-repeat;
        }

        @keyframes drift {
            0% { transform: translateY(0) rotate(-10deg); opacity: 0; }
            20% { opacity: 0.4; }
            80% { opacity: 0.4; }
            100% { transform: translateY(-120vh) rotate(60deg); opacity: 0; }
        }

        .glass-ui {
            background: rgba(30, 30, 30, 0.5);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: 1.75rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1) inset, 0 10px 40px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }
        
        .main-card {
            display: flex;
            flex-direction: column;
            height: 80vh;
            max-height: 700px;
            transform: translateZ(0);
        }
        
        .content-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 0 1.5rem 3rem; 
            -webkit-overflow-scrolling: touch;
        }

        .tab-button {
            transition: color 0.3s ease;
            background: transparent;
            border: 1px solid transparent;
            color: rgba(255, 255, 255, 0.6);
        }
        .tab-button.active { color: #fff; }
        .tab-button svg { width: 24px; height: 24px; margin: 0 auto; }
        #tab-indicator {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 9999px;
            z-index: 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.05) inset, 0 0 15px 2px rgba(255, 255, 255, 0.1);
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .content-area::-webkit-scrollbar { width: 6px; }
        .content-area::-webkit-scrollbar-track { background: transparent; }
        .content-area::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); border-radius: 10px; }
    </style>
</head>
<body>
    <audio id="birthday-audio" src="https://raw.githubusercontent.com/Sarup098/codebd/main/happy-birthday-334876.mp3"></audio>

    <!-- NEW Candle Blowing Screen -->
    <div id="candle-screen">
        <button id="start-button">Tap to make a wish!</button>
        <div class="cake" id="cake-holder" style="display: none;">
            <div class="plate"></div>
            <div class="layer layer-bottom"></div>
            <div class="layer layer-middle"></div>
            <div class="layer layer-top"></div>
            <div class="icing"></div>
            <div class="drip drip1"></div>
            <div class="drip drip2"></div>
            <div class="drip drip3"></div>
            <div class="candle">
                <div class="flame"></div>
            </div>
        </div>
        <p id="blow-instruction" style="display: none;">Make a wish and blow out the candle!</p>
    </div>

    <!-- Cake Cutting Intro (initially hidden) -->
    <div id="cake-intro" style="display: none;">
        <div id="swipe-instruction">Swipe down to cut the cake!</div>
        <div class="intro-shape intro-shape-1"></div>
        <div class="intro-shape intro-shape-2"></div>
        <div id="confetti-container"></div>
        <div id="cake-container">
            <img id="cake-left" class="cake-piece" src="https://raw.githubusercontent.com/Sarup098/codebd/main/IMG_8240.png" alt="Left side of cake">
            <img id="cake-right" class="cake-piece" src="https://raw.githubusercontent.com/Sarup098/codebd/main/IMG_8241.png" alt="Right side of cake">
            <canvas id="cut-canvas"></canvas>
        </div>
        <div id="muahhh-text">muahhh!</div>
    </div>

    <!-- Main Content (initially hidden) -->
    <div id="main-content" class="min-h-screen flex items-center justify-center p-4">
        <div class="background-container"></div>
        <div class="w-full max-w-md mx-auto">
            <header class="text-center mb-6">
                <h1 class="text-5xl font-bold text-white">Happy Birthday ASSna</h1>
                <p class="text-white/80 mt-1 text-lg">You are my sweetest blessing and my sexiest addiction.</p>
            </header>
            <main class="glass-ui main-card">
                <div class="relative flex justify-around space-x-2 p-2 glass-ui rounded-full m-4">
                    <div id="tab-indicator"></div>
                    <button class="tab-button w-full py-2 px-4 rounded-full active z-10" onclick="showTab('message', this)" title="Message"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg></button>
                    <button class="tab-button w-full py-2 px-4 rounded-full z-10" onclick="showTab('video', this)" title="Video"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.357-.466.557-.327l5.603 3.112z" /></svg></button>
                    <button class="tab-button w-full py-2 px-4 rounded-full z-10" onclick="showTab('date-night', this)" title="Date Night"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" /></svg></button>
                </div>
                <div class="content-area">
                    <div id="message" class="tab-content active"><h2 class="text-4xl font-semibold mb-4 text-white">From My Heart</h2><div class="space-y-4 text-white/90 pb-40"><p>Thank you for being everything to me ... muahhh, my perfect girlfriend.</p><p>YOU cnnot read this message this was just for ASSna<p>Forever yours!</p></div></div>
                    <div id="video" class="tab-content"><h2 class="text-4xl font-semibold mb-4 text-white">For You</h2><div class="aspect-w-9 aspect-h-16 max-w-xs mx-auto rounded-lg overflow-hidden border-2 border-white/30"><iframe src="https://www.youtube.com/embed/XcbP_cCkQqs" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><p class="text-sm text-center mt-4 text-white/70">a small gift for my fav Girl!!</p></div>
                    <div id="date-night" class="tab-content text-center"><h2 class="text-4xl font-semibold mb-4 text-white">You're Invited!</h2><div class="bg-black/20 p-6 rounded-lg mb-6 text-left"><h3 class="text-4xl font-bold mb-3 text-white text-center">Jhalmuri Date Night</h3><p class="text-white/90 mb-2"><strong class="font-semibold">When:</strong> August 27th</p><p class="text-white/90 mb-4"><strong class="font-semibold">Time:</strong> 9:00 PM onwards</p><p class="text-white/80 mb-4">Let's make and eat Jhalmuri together!  At the end, we'll click a screenshot to remember our perfect date.</p><h4 class="font-semibold text-white mb-2 text-2xl">Your Ingredient Checklist:</h4><ul class="list-disc list-inside text-white/80 space-y-1"><li>Puffed rice (Muri)</li><li>wai-wai(veg ofcc)</li><li>Green chillies (or thika laal)</li><li>anything else you can lemon, onion, etc</li></ul></div><h2 class="text-4xl font-semibold mb-4 text-white">Will You Join Me?</h2><form class="space-y-4 text-left"><div><label for="name" class="block text-sm font-medium text-white/90">Your Name:</label><input type="text" id="name" name="name" required class="mt-1 block w-full bg-black/20 border-transparent rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-white/50 placeholder-white/60" placeholder="ASSna"></div><div><label class="block text-sm font-medium text-white/90">Your Answer:</label><div class="mt-2 space-y-2"><label class="inline-flex items-center"><input type="radio" name="attendance" value="Yes, a thousand times yes!" class="form-radio text-pink-400 focus:ring-pink-500" checked><span class="ml-2 text-white/90">Yes, a thousand times yes!</span></label><br><label class="inline-flex items-center"><input type="radio" name="attendance" value="Of course! Can't wait!" class="form-radio text-pink-400 focus:ring-pink-500"><span class="ml-2 text-white/90">Of course! Can't wait!</span></label></div></div><div><label for="message-response" class="block text-sm font-medium text-white/90">A little message for me?</label><textarea id="message-response" name="message" rows="3" class="mt-1 block w-full bg-black/20 border-transparent rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-white/50 placeholder-white/60"></textarea></div><div class="pb-32"><button type="button" id="send-to-whatsapp" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-4 rounded-full transition duration-300 transform hover:scale-105">Send My Response</button></div></form></div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // --- Candle Blowing Logic ---
        const candleScreen = document.getElementById('candle-screen');
        const startButton = document.getElementById('start-button');
        const cakeHolder = document.getElementById('cake-holder');
        const blowInstruction = document.getElementById('blow-instruction');
        const flame = document.querySelector('#cake-holder .flame');
        let audioContext, analyser, dataArray;

        startButton.addEventListener('click', async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const source = audioContext.createMediaStreamSource(stream);
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 256;
                source.connect(analyser);
                dataArray = new Uint8Array(analyser.frequencyBinCount);

                startButton.style.display = 'none';
                cakeHolder.style.display = 'block';
                blowInstruction.style.display = 'block';
                
                detectBlow();
            } catch (err) {
                console.error('Microphone access denied:', err);
                alert('Please allow microphone access to blow out the candle!');
            }
        });

        function detectBlow() {
            if (!flame || flame.classList.contains('out')) return;

            analyser.getByteFrequencyData(dataArray);
            let sum = dataArray.reduce((a, b) => a + b, 0);
            let average = sum / dataArray.length;

            if (average > 60) {
                flame.classList.add('out');
                setTimeout(() => {
                    candleScreen.style.opacity = '0';
                    setTimeout(() => {
                        candleScreen.style.display = 'none';
                        document.getElementById('cake-intro').style.display = 'flex';
                    }, 1000);
                }, 500);
            } else {
                requestAnimationFrame(detectBlow);
            }
        }

        // --- Cake Intro Logic ---
        const cakeIntro = document.getElementById('cake-intro');
        const cakeContainer = document.getElementById('cake-container');
        const cakeLeft = document.getElementById('cake-left');
        const cakeRight = document.getElementById('cake-right');
        const mainContent = document.getElementById('main-content');
        const canvas = document.getElementById('cut-canvas');
        const birthdayAudio = document.getElementById('birthday-audio');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let hasCut = false;

        function launchConfetti() {
            const confettiContainer = document.getElementById('confetti-container');
            const colors = ['#f68787', '#f8a978', '#f6d55c', '#3caea3', '#20639b', '#FFFFFF'];
            for (let i = 0; i < 250; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                const size = Math.random() * 10 + 5;
                confetti.style.width = `${size}px`;
                if (Math.random() > 0.5) { confetti.style.height = `${size}px`; } else { confetti.style.height = `${size * 2}px`; }
                if (Math.random() > 0.8) { confetti.style.borderRadius = '50%'; }
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                confetti.style.animationDuration = `${Math.random() * 3 + 4}s`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                confettiContainer.appendChild(confetti);
            }
        }

        function startCut(e) {
            if (hasCut) return;
            isDrawing = true;
            ctx.beginPath();
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            ctx.moveTo(x, 0);
        }

        function drawCut(e) {
            if (!isDrawing || hasCut) return;
            const rect = canvas.getBoundingClientRect();
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            ctx.lineTo(x, y);
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.lineWidth = 4;
            ctx.stroke();
            if (y > canvas.height * 0.8) { endCut(); }
        }

        function endCut() {
            if (!isDrawing || hasCut) return;
            isDrawing = false;
            hasCut = true;
            
            birthdayAudio.play().catch(e => console.error("Audio play failed:", e));

            launchConfetti();
            cakeLeft.style.transform = 'translateX(-50%) rotate(-15deg) scale(0.8)';
            cakeRight.style.transform = 'translateX(50%) rotate(15deg) scale(0.8)';
            setTimeout(() => {
                cakeIntro.style.opacity = '0';
                mainContent.style.opacity = '1';
                setTimeout(() => cakeIntro.style.display = 'none', 1000);
            }, 1500);
        }

        cakeContainer.addEventListener('mousedown', startCut);
        cakeContainer.addEventListener('mousemove', drawCut);
        window.addEventListener('mouseup', endCut);
        cakeContainer.addEventListener('touchstart', startCut);
        cakeContainer.addEventListener('touchmove', drawCut);
        window.addEventListener('touchend', endCut);

        // --- Tab Switching Logic ---
        function showTab(tabId, clickedButton) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => button.classList.remove('active'));
            clickedButton.classList.add('active');
            const indicator = document.getElementById('tab-indicator');
            indicator.style.width = `${clickedButton.offsetWidth}px`;
            indicator.style.transform = `translateX(${clickedButton.offsetLeft}px)`;
        }

        // --- WhatsApp Redirect Logic ---
        const whatsappButton = document.getElementById('send-to-whatsapp');
        whatsappButton.addEventListener('click', function() {
            const name = document.getElementById('name').value;
            const attendance = document.querySelector('input[name="attendance"]:checked').value;
            const message = document.getElementById('message-response').value;
            const phoneNumber = '919907488075';
            let whatsappMessage = `Hey Sarup! It's ${name}.\n\nMy answer for our date is: *${attendance}*`;
            if (message) {
                whatsappMessage += `\n\nAnd a little something for you:\n_"${message}"_`;
            }
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(whatsappMessage)}`;
            window.open(whatsappUrl, '_blank');
        });

        // --- On Page Load Logic ---
        document.addEventListener('DOMContentLoaded', function() {
            const playAudioOnFirstInteraction = () => {
                birthdayAudio.volume = 0.5;
                birthdayAudio.play().catch(e => console.error("Audio play failed:", e));
                cakeIntro.removeEventListener('touchstart', playAudioOnFirstInteraction);
                cakeIntro.removeEventListener('mousedown', playAudioOnFirstInteraction);
            };
            cakeIntro.addEventListener('touchstart', playAudioOnFirstInteraction, { once: true });
            cakeIntro.addEventListener('mousedown', playAudioOnFirstInteraction, { once: true });


            // --- Particle Generation ---
            const particleContainer = document.querySelector('.background-container');
            const particleCount = 12;
            const imageUrls = [
                'https://raw.githubusercontent.com/Sarup098/codebd/main/Untitled_Artwork.jpg',
                'https://raw.githubusercontent.com/Sarup098/codebd/main/IMG_8211.PNG',
                'https://raw.githubusercontent.com/Sarup098/codebd/main/Untitled_Artwork%205.png'
            ];
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.backgroundImage = `url(${imageUrls[i % imageUrls.length]})`;
                const size = Math.random() * 80 + 50;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                const animationDuration = Math.random() * 20 + 15;
                particle.style.animationDuration = `${animationDuration}s`;
                const animationDelay = Math.random() * 20;
                particle.style.animationDelay = `-${animationDelay}s`;
                particleContainer.appendChild(particle);
            }
            
            // --- Set Initial Tab Indicator Position ---
            const initialActiveButton = document.querySelector('.tab-button.active');
            if (initialActiveButton) {
                const indicator = document.getElementById('tab-indicator');
                indicator.style.transition = 'none';
                indicator.style.width = `${initialActiveButton.offsetWidth}px`;
                indicator.style.transform = `translateX(${initialActiveButton.offsetLeft}px)`;
                setTimeout(() => {
                    indicator.style.transition = 'all 0.5s cubic-bezier(0.23, 1, 0.32, 1)';
                }, 50);
            }
        });
    </script>
</body>
</html>
